"use strict";!function(){angular.module("app",["app.core","app.services","app.resources","app.modals","app.filters","app.admin.panel","app.admin.dashboard","app.manager.dashboard","app.kitchen.orders","app.auth","app.layout"]).config(["localStorageServiceProvider","$anchorScrollProvider","ngDialogProvider","$httpProvider",function(e,a,o,t){e.setPrefix("YOKI-CRM").setStorageType("localStorage").setNotify(!0,!0),o.setDefaults({showClose:!0}),t.interceptors.push("apiInterceptor"),a.disableAutoScrolling(),t.defaults.useXDomain=!0,t.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",t.defaults.headers.post["Content-Type"]="application/json",t.defaults.headers.post.Accept="application/json"}]).run(["$rootScope","$location","user","USER_ROLES","helpers",function(e,a,o,t,r){e.location=a,e.go=function(e){a.path(e)},e.defaultRedirect=function(){return r.findString(o.roles(),t.admin)?void a.path("/admin/dashboard"):r.findString(o.roles(),t.manager)?void a.path("/manager/dashboard"):r.findString(o.roles(),t.kitchen)?void a.path("/kitchen/orders"):void 0}}])}();
"use strict";!function(){angular.module("app.core",["ngAnimate","ngResource","ngRoute","ngSanitize","ngLocale","ngDialog","LocalStorageModule","angular-jwt","templates","ngplus","720kb.datepicker","ui.mask","angular-click-outside","blocks.helpers","blocks.exception","blocks.logger","blocks.router","blocks.splash","blocks.edit-field","blocks.refresh-btn","blocks.image-upload","blocks.validator","blocks.dish-switch"])}();
"use strict";!function(){angular.module("app.filters",[])}();
"use strict";!function(){angular.module("app.layout",[])}();
"use strict";!function(){angular.module("app.modals",[])}();
"use strict";!function(){angular.module("app.resources",[])}();
"use strict";!function(){angular.module("app.services",[])}();
"use strict";!function(){angular.module("blocks.dish-switch",[])}();
"use strict";!function(){angular.module("blocks.exception",["blocks.logger"])}();
"use strict";!function(){angular.module("blocks.logger",[])}();
"use strict";!function(){angular.module("blocks.refresh-btn",[])}();
"use strict";!function(){angular.module("blocks.router",["ngRoute","blocks.logger"])}();
"use strict";!function(){angular.module("blocks.splash",[])}();
"use strict";!function(){angular.module("blocks.validator",[])}();
"use strict";!function(){angular.module("app.admin.dashboard",[])}();
"use strict";!function(){angular.module("app.admin.panel",[])}();
"use strict";!function(){angular.module("app.auth",[])}();
"use strict";!function(){angular.module("app.kitchen.orders",[])}();
"use strict";!function(){angular.module("app.manager.dashboard",[])}();
"use strict";angular.module("ngLocale",[],["$provide",function(e){function M(e){e+="";var M=e.indexOf(".");return M==-1?0:e.length-M-1}function r(e,r){var n=r;void 0===n&&(n=Math.min(M(e),3));var E=Math.pow(10,n),a=(e*E|0)%E;return{v:n,f:a}}var n={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};e.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],ERANAMES:["до н. э.","н. э."],ERAS:["до н. э.","н. э."],FIRSTDAYOFWEEK:0,MONTH:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],SHORTDAY:["вс","пн","вт","ср","чт","пт","сб"],SHORTMONTH:["янв.","февр.","марта","апр.","мая","июня","июля","авг.","сент.","окт.","нояб.","дек."],STANDALONEMONTH:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d MMMM y 'г'.",longDate:"d MMMM y 'г'.",medium:"d MMM y 'г'. HH:mm:ss",mediumDate:"d MMM y 'г'.",mediumTime:"HH:mm:ss","short":"dd.MM.yy HH:mm",shortDate:"dd.MM.yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"₴",DECIMAL_SEP:",",GROUP_SEP:" ",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"ru-ua",localeID:"ru_UA",pluralCat:function(e,M){var E=0|e,a=r(e,M);return 0==a.v&&E%10==1&&E%100!=11?n.ONE:0==a.v&&E%10>=2&&E%10<=4&&(E%100<12||E%100>14)?n.FEW:0==a.v&&E%10==0||0==a.v&&E%10>=5&&E%10<=9||0==a.v&&E%100>=11&&E%100<=14?n.MANY:n.OTHER}})}]);
"use strict";!function(){function t(t,o,n){function r(){return o.$broadcast.apply(o,arguments)}function c(){return o.$emit.apply(o,arguments)}var e={$broadcast:r,$emit:c,$q:t,$timeout:n};return e}angular.module("app.core").factory("common",t),t.$inject=["$q","$rootScope","$timeout"]}();
"use strict";!function(){function t(t){t.options.timeOut=3e3,t.options.positionClass="toast-bottom-right"}function e(t,e,r,o){t.debugEnabled&&t.debugEnabled(!0),r.config.$routeProvider=e;var n={ready:["dataservice",function(t){return t.ready()}]};r.config.resolveAlways=n,o.configure(a.appErrorPrefix)}function r(t,e,r){t.$on("$locationChangeStart",function(o){var n=e.routes[t.location.path()];n||(o.preventDefault(),r.isAuth()?t.defaultRedirect():t.go("/auth"))})}function o(t,e,r,o,n){t.$on("$locationChangeStart",function(i){var a=e.routes[t.location.path()];if(a.data&&a.data.authorities){var u=!1;a.data.authorities.forEach(function(t){o.findString(r.roles(),t)&&(u=!0)}),u||(i.preventDefault(),t.defaultRedirect(),n.error("Помилка доступу"))}})}function n(t,e,r){r.tokenGetter=["jwtHelper","$http","user","storage","$location",function(e,r,o,n,i){var a=n.get("token");if(angular.isDefined(a))return e.isTokenExpired(a)?r({url:t.apiUrl+"/auth/refresh",skipAuthorization:!1,method:"POST",headers:{Authorization:"Bearer "+a}}).then(function(t){var e=t.data.token;return n.set("token",e),e},function(){o.logout()}):a}],e.interceptors.push("jwtInterceptor")}t.$inject=["toastr"];var i=angular.module("app.core"),a={appErrorPrefix:"[YOKI-CRM Error] ",appTitle:"YOKI CRM",version:"1.0.0"};i.value("config",a),i.config(t),i.config(e),i.config(n),i.run(r),i.run(o),e.$inject=["$logProvider","$routeProvider","routehelperConfigProvider","exceptionHandlerProvider"],r.$inject=["$rootScope","$route","user"],o.$inject=["$rootScope","$route","user","helpers","logger"],n.$inject=["ENV","$httpProvider","jwtInterceptorProvider"]}();
"use strict";!function(){angular.module("app.core").constant("ENV",{apiUrl:"http://46.101.230.74:8080"}).constant("APP_EVENTS",{serverError:"server-error",userLogin:"user-enter",userLogout:"user-logout",immediatelyRefreshPage:"immediately-refresh-page",refreshPage:"refresh-page",refreshPageDone:"refresh-page-done"}).constant("USER_ROLES",{admin:"ROLE_ADMINISTRATOR",manager:"ROLE_OPERATOR",kitchen:"ROLE_KITCHEN",guest:"ROLE_GUEST"}).constant("toastr",toastr).constant("moment",moment)}();
"use strict";!function(){function n(n,t){function e(){function t(){a=!0}return c?c:c=n.when(!0).then(t)}function r(r){var a=c||e();return a.then(function(){return n.all(r)})["catch"](t.catcher('"ready" function failed'))}var c,a=!1,u={ready:r};return u}angular.module("app.core").factory("dataservice",n),n.$inject=["$q","exception"]}();
"use strict";!function(){function t(){function t(t){return t.charAt(0).toUpperCase()}return t}angular.module("app.filters").filter("firstLetter",t)}();
"use strict";!function(){function r(r,e,n,o,a,t){function i(){var r="адміністратор",e=t.roles();return o.findString(e,a.manager)&&(r="менеджер"),o.findString(e,a.kitchen)&&(r="кухня"),r}function l(){e.scope.createEnabled=!0,e.show()}function c(){n.show()}var d=this;d.roleName=i(),d.orderHistory=r.show,d.createNewOrder=l,d.callCourier=c}angular.module("app.layout").controller("Header",r),r.$inject=["orderHistoryIntervalModal","managerOrderDetailModal","adminCallCourierModal","helpers","USER_ROLES","user"]}();
"use strict";!function(){function i(i,n,o,t,e){function s(){e.ready().then(function(){u()})}function u(){i(function(){c.showSplash=!1},1e3)}function a(){t.logout()}var c=this;c.showSplash=!1,c.user=t.info(),c.isAdmin=t.isAdmin(),c.isKitchen=t.isKitchen(),c.isManager=t.isManager(),c.logout=a,s(),n.$on(o.userLogin,function(){c.user=t.info(),c.isAdmin=t.isAdmin(),c.isKitchen=t.isKitchen(),c.isManager=t.isManager()})}angular.module("app.layout").controller("Shell",i),i.$inject=["$timeout","$rootScope","APP_EVENTS","user","dataservice"]}();
"use strict";function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}();!function(){function e(e){var n=[],r=function(){function r(e,t){_classCallCheck(this,r),this._subscribers={},this.events=t||{},this.scope={},n.push(_defineProperty({},e,this))}return _createClass(r,[{key:"on",value:function(e,n){this._subscribers[e]=n}},{key:"emit",value:function(e){for(var n=this._subscribers[e],r=arguments.length,t=Array(r>1?r-1:0),a=1;a<r;a++)t[a-1]=arguments[a];n.apply(n,t)}}],[{key:"get",value:function(e){var r={};return n.forEach(function(n){n[e]&&(r=n[e])}),r}},{key:"getClassName",value:function(){return e.isManager()?"manager-modal":""}}]),r}();return r}angular.module("app.modals").factory("BaseModal",e),e.$inject=["user"]}();
"use strict";!function(){function a(a){return a("/admin/:action/:data",{},{create:{method:"POST",params:{action:"create"}},fetchAll:{method:"GET",isArray:!0,params:{action:"getAll"}},history:{method:"GET",isArray:!0,params:{action:"getOrderHistory"}},makeInCooking:{method:"POST",params:{action:"proceedToCooking"}},passOrdersToCourier:{method:"POST",params:{action:"passOrdersToCourier"}},courierOnPlace:{method:"POST",params:{action:"courierOnPlace"}},callCourier:{method:"POST",params:{action:"callCourierToBase"}},declineCallCourier:{method:"POST",params:{action:"declineCallCourierToBase"}}})}angular.module("app.resources").factory("admin",a),a.$inject=["$resource"]}();
"use strict";!function(){function t(t){return t("/auth/:action/:data",{},{login:{method:"POST",params:{action:""}}})}angular.module("app.resources").factory("auth",t),t.$inject=["$resource"]}();
"use strict";!function(){function e(e){return e("/category/:action/:id",{},{fetchAll:{method:"GET",isArray:!0,params:{action:"getAll"}},fetchDishes:{method:"GET",isArray:!0,params:{action:"getAllDishesFromCategory"}},create:{method:"POST",params:{action:"create"}},remove:{method:"GET",params:{action:"remove"}},removeDish:{method:"POST",params:{action:"removeDishFromCategory"}}})}angular.module("app.resources").factory("categories",e),e.$inject=["$resource"]}();
"use strict";!function(){function r(r){return r("/courier/:action/:data",{},{fetchAll:{method:"GET",isArray:!0,params:{action:"getAllCouriers"}},fetchFree:{method:"GET",isArray:!0,params:{action:"getFreeCouriers"}}})}angular.module("app.resources").factory("courier",r),r.$inject=["$resource"]}();
"use strict";!function(){function a(a){return a("/dish/:action/:data",{},{create:{method:"POST",params:{action:"create"}},update:{method:"POST",params:{action:"update"}},activate:{method:"POST",params:{action:"activate"}},deactivate:{method:"POST",params:{action:"deactivate"}}})}angular.module("app.resources").factory("dishes",a),a.$inject=["$resource"]}();
"use strict";!function(){function e(e){return e("/images/:action/:data",{},{remove:{method:"POST",params:{action:"removeImages"}},upload:{method:"POST",transformRequest:angular.identity,headers:{"Content-Type":void 0},params:{action:"addImages"}}})}angular.module("app.resources").factory("images",e),e.$inject=["$resource"]}();
"use strict";!function(){function r(r){return r("/kitchen/:action/:data",{},{fetchAll:{method:"GET",isArray:!0,params:{action:"getOrders"}},prepared:{method:"POST",params:{action:"orderPrepared"}},notPrepared:{method:"POST",params:{action:"orderNotPrepared"}}})}angular.module("app.resources").factory("kitchen",r),r.$inject=["$resource"]}();
"use strict";!function(){function r(r){return r("/operator/:action/:data",{},{makeInProgress:{method:"POST",params:{action:"setOrderInProgress"}},close:{method:"POST",params:{action:"closeOrder"}},makeCall:{method:"POST",params:{action:"makeCall"}}})}angular.module("app.resources").factory("operator",r),r.$inject=["$resource"]}();
"use strict";!function(){function e(e){return e("/order/:action/:data",{},{create:{method:"POST",params:{action:"createOrder"}},fetchAvailable:{method:"GET",isArray:!0,params:{action:"getAvailableOrders"}},fetchAll:{method:"GET",isArray:!0,params:{action:"getAllOrders"}},decline:{method:"POST",params:{action:"declineOrder"}},update:{method:"POST",params:{action:"updateOrder"}},getDishes:{method:"POST",isArray:!0,params:{action:"getDishes"}}})}angular.module("app.resources").factory("orders",e),e.$inject=["$resource"]}();
"use strict";!function(){angular.module("app.services").factory("apiInterceptor",["$rootScope","$q","ENV","exception",function(r,t,e,u){return{request:function(r){return r.uri=r.url,r.url.indexOf("html/",0)==-1&&(r.url=e.apiUrl+r.url),r},requestError:function(r){return t.reject(r)},responseError:function(r){return 401===r.status||403===r.status?u.catcher("Помилка входу в систему")(r):u.catcher("XHR помилка для "+r.config.uri)(r),t.reject(r)}}}])}();
"use strict";!function(){function e(e){return{set:function(t,n){e.set(t,n)},get:function(t,n){return e.get(t)||n},remove:function(t){e.remove(t)},setObject:function(t,n){e.set(t,JSON.stringify(n))},getObject:function(t){return JSON.parse(e.get(t))||{}},getArray:function(t){return JSON.parse(e.get(t))||[]}}}angular.module("app.services").factory("storage",e),e.$inject=["localStorageService"]}();
"use strict";!function(){function n(n,e,t,r,o,u,i,c,a){function f(){var n=a.get("token");E=!!n}function s(r){var o=n.defer();return c.login(r,function(n){m(n.token)?(a.set("token",n.token),E=!0,e.$broadcast(t.userLogin),o.resolve(n)):o.reject()},function(n){o.reject(n)}),o.promise}function g(){E=!1,a.remove("token"),o.path("/auth")}function l(){var n=a.get("token");if(n)return u.decodeToken(n)}function h(){var n=l(),e=[];return n?n.userRoles.forEach(function(n){e.push(n.name)}):e.push(r.guest),e}function d(){return p(r.admin)}function v(){return p(r.manager)}function k(){return p(r.kitchen)}function p(n){var e=h(),t=!1;return e&&i.findString(e,n)&&(t=!0),t}function m(n){var e=u.decodeToken(n),t=!0;return e.userRoles.forEach(function(n){"ROLE_COURIER"===n.name&&(t=!1)}),t}var E=!1,R={login:s,logout:g,info:l,roles:h,isAdmin:d,isManager:v,isKitchen:k,isAuth:function(){return E}};return f(),R}angular.module("app.services").factory("user",n),n.$inject=["$q","$rootScope","APP_EVENTS","USER_ROLES","$location","jwtHelper","helpers","auth","storage"]}();
"use strict";!function(){function i(i,e){return{restrict:"E",replace:!0,scope:{},require:"ngModel",templateUrl:"html/blocks/dish-switch/dish-switch.html",link:function(e,t,d,n){e.knobLabel=" ",t.on("click",function(){e.$apply(function(){e.dish.enabled=!e.dish.enabled,n.$setViewValue(e.dish),n.$render(),e.dish.enabled===!0?i.activate({id:e.dish.id}):i.deactivate({id:e.dish.id})})}),n.$render=function(){e.dish=n.$viewValue},n.$render()}}}angular.module("blocks.dish-switch").directive("dishSwitch",i),i.$inject=["dishes","toastr"]}();
"use strict";!function(){function e(e,t){return{restrict:"E",replace:!0,transclude:!0,scope:{placeholder:"@",required:"@",mask:"@"},require:"ngModel",templateUrl:"html/blocks/edit-field/edit-field.html",link:function(i,d,n,l){i.editMode=!1,i.editModeOn=function(){var e=void 0,n=void 0;n=i.mask?d[0].getElementsByClassName("edit-field-input-mask"):d[0].getElementsByClassName("edit-field-input"),t(function(){e=angular.element(n),e[0].focus()},100),i.fieldData=l.$viewValue,i.editMode=!0},i.editModeOff=function(){i.fieldData=l.$viewValue,i.editMode=!1},i.editSave=function(){!i.fieldData&&i.required?e.error("Поле не повинно бути порожнім!"):(l.$setViewValue(i.fieldData),l.$render(),i.editModeOff())};var a=d[0].getElementsByClassName("field-data-value"),r=angular.element(a);r.bind("click",function(){i.$apply(function(){i.editModeOn()}),event.preventDefault()}),d.bind("keydown keypress",function(e){13===e.which&&(i.$apply(function(){i.editSave()}),e.preventDefault())}),l.$render=function(){i.fieldData=l.$viewValue},l.$render()}}}angular.module("blocks.edit-field",[]).directive("editField",e),e.$inject=["toastr","$timeout"]}();
"use strict";!function(){function e(){this.config={appErrorPrefix:void 0},this.configure=function(e){this.config.appErrorPrefix=e},this.$get=function(){return{config:this.config}}}function n(e){e.decorator("$exceptionHandler",i)}function i(e,n,i){return function(r,o){var t=n.config.appErrorPrefix||"",c={exception:r,cause:o};r.message=t+r.message,e(r,o),i.error(r.message,c)}}n.$inject=["$provide"],i.$inject=["$delegate","exceptionHandler","logger"],angular.module("blocks.exception").provider("exceptionHandler",e).config(n)}();
"use strict";!function(){function n(n){function r(r){return function(t){n.error(r,t)}}var t={catcher:r};return t}n.$inject=["logger"],angular.module("blocks.exception").factory("exception",n)}();
"use strict";!function(){function r(r){var t={};return t.shapeArrayInRows=function(r,t){for(var n=[],e=0;e<r.length;e+=t)n.push(r.slice(e,e+t));return n},t.searchByKey=function(r,t){var n=Object.keys(t),e=void 0;return r.forEach(function(r){r[n[0]]==t[n[0]]&&(e=r)}),e},t.searchIndex=function(r,t){for(var n=Object.keys(t),e=void 0,u=0;u<r.length;u++)r[u][n[0]]==t[n[0]]&&(e=u);return e},t.nextElementInArray=function(r,t){var n=Object.keys(t),e=void 0;return r.forEach(function(r,u,i){r[n[0]]==t[n[0]]&&(e=i[u+1])}),e},t.prevElementInArray=function(r,t){var n=Object.keys(t),e=void 0;return r.forEach(function(r,u,i){r[n[0]]==t[n[0]]&&(e=i[u-1])}),e},t.findString=function(r,t){var n=!1;return r.forEach(function(r){r===t&&(n=r)}),n},t.compareById=function(r,t){return r.id>t.id?-1:r.id<t.id?1:0},t.filterOrdersByStatus=function(r,n){var e=[];return r.forEach(function(r){t.findString(n,r.status)&&e.push(r)}),e},t.calculateOrderInfo=function(r){var t={price:0,count:0},n=!0,e=!1,u=void 0;try{for(var i,o=r.dishes[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var a=i.value;t.price+=a.dish.price*a.quantity,t.count+=a.quantity}}catch(c){e=!0,u=c}finally{try{!n&&o["return"]&&o["return"]()}finally{if(e)throw u}}return t},t.getDate=function(){var r=new Date,t=r.getDate(),n=r.getMonth()+1,e=r.getFullYear();t<10&&(t="0"+t),n<10&&(n="0"+n);var u=e+"-"+n+"-"+t;return{yyyy:e,mm:n,dd:t,str:u}},t.getHourMinutes=function(r){if(r)return{hours:r.substr(0,2),minutes:r.substr(2,4)}},t.parseDate=function(n){var e=r("date")(n,"HHmm"),u=t.getHourMinutes(e);return""+u.hours+u.minutes},t.convertHHmm=function(r){if(r){var n=t.getHourMinutes(r);if(n)return n.hours+":"+n.minutes}},t}angular.module("blocks.helpers",[]).factory("helpers",r),r.$inject=["$filter"]}();
"use strict";!function(){function e(e,a,i,r){return{restrict:"E",replace:!0,scope:{},require:"ngModel",templateUrl:"html/blocks/image-upload/image-upload.html",link:function(t,n,s,l){function o(e){for(var a=r.defer(),i=0,t=[],n=0;n<e.length;n++){var s=new FileReader;s.onload=function(r){i++,t.push(btoa(r.target.result)),i===e.length&&a.resolve(t)},s.readAsBinaryString(e[n])}return a.promise}function u(e){return i.apiUrl+e}function g(e){t.images.splice(t.images.indexOf(e),1),a.remove([e.link]),t.images.length||(t.uploaded=!1,l.$setValidity("arrayRequired",!1)),l.$setViewValue(t.images)}function m(e){t.previewImages.splice(t.previewImages.indexOf(e),1),t.previewImages.length||(t.uploaded=!1,l.$setValidity("arrayRequired",!1))}function d(e){for(var a={status:!0,reason:null},i=0;i<e.length;i++)e[i].size>p.max_filesize&&(a.status=!1,a.reason="max_filesize"),p.types.indexOf(e[i].type)===-1&&(a.status=!1,a.reason="format");return a}function c(a){var i="";switch(a.reason){case"max_filesize":i="Максимальний розмір файла 2Мб";break;case"format":i="Заборонений тип файлу"}e.error(i)}t.uploaded=!1,t.previewImages=[],t.images=[],t.removeImage=g,t.removePreview=m,t.fullPath=u,t.$watch(function(){return l.$modelValue},function(e){e.length&&(t.uploaded=!0,t.images=l.$viewValue),l.$render()});var f=n.find("input"),p={max_filesize:2097152,types:["image/png","image/jpg","image/jpeg"]};f.on("change",function(e){var a=[];angular.forEach(e.target.files,function(e){a.push(e)});var i=d(a);i.status?r.all([o(a)]).then(function(e){t.previewImages=e[0],t.uploaded=!0,l.$setViewValue(a),l.$setValidity("arrayRequired",!0)}):c(i)})}}}angular.module("blocks.image-upload",[]).directive("imageUpload",e),e.$inject=["toastr","images","ENV","$q"]}();
"use strict";!function(){function n(n,o){function r(r,c,i){o.error(r,i),n.error("Error: "+r,c)}function c(r,c,i){o.info(r,i),n.info("Info: "+r,c)}function i(r,c,i){o.success(r,i),n.info("Success: "+r,c)}function s(r,c,i){o.warning(r,i),n.warn("Warning: "+r,c)}var t={showToasts:!0,error:r,info:c,success:i,warning:s,log:n.log};return t}angular.module("blocks.logger").factory("logger",n),n.$inject=["$log","toastr"]}();
"use strict";!function(){function e(e,r,n){return{restrict:"E",replace:!0,scope:{},templateUrl:"html/blocks/refresh-btn/refresh-btn.html",link:function(t){function o(){t.refreshEnabled||(n.cancel(f),c())}function c(){r.$broadcast(e.refreshPage),t.refreshEnabled=!0}function s(){f=n(c,2e4)}t.refreshPage=o,t.refreshEnabled=!1;var f=void 0;s();var a=r.$on(e.refreshPageDone,function(){t.refreshEnabled=!1,s()}),i=r.$on(e.immediatelyRefreshPage,function(){o()});t.$on("$destroy",function(){f&&n.cancel(f)}),t.$on("$destroy",a),t.$on("$destroy",i)}}}angular.module("blocks.refresh-btn").directive("refreshBtn",e),e.$inject=["APP_EVENTS","$rootScope","$timeout"]}();
"use strict";!function(){function o(){this.config={},this.$get=function(){return{config:this.config}}}function r(o,r,e,t,n){function i(o){o.forEach(function(o){o.config.resolve=angular.extend(o.config.resolve||{},n.config.resolveAlways),l.when(o.url,o.config)}),l.otherwise({redirectTo:"/auth"})}function u(){r.$on("$routeChangeError",function(r,e,n,i){if(!g){s.errors++,g=!0;var u=e&&(e.title||e.name||e.loadedTemplateUrl)||"unknown target",c="Error routing to "+u+". "+(i.msg||"");t.warning(c,[e]),o.path("/")}})}function c(){u()}function f(){for(var o in e.routes)if(e.routes.hasOwnProperty(o)){var r=e.routes[o],t=!!r.title;t&&a.push(r)}return a}var g=!1,s={errors:0},a=[],l=n.config.$routeProvider,h={configureRoutes:i,getRoutes:f,routeCounts:s};return c(),h}angular.module("blocks.router").provider("routehelperConfig",o).factory("routehelper",r),r.$inject=["$location","$rootScope","$route","logger","routehelperConfig"]}();
"use strict";!function(){function e(e,n){function t(t){n.splashScreen=!0,e.$q.all(t).then(function(){e.$timeout(function(){n.splashScreen=!1},600)})}function c(){e.$timeout(function(){n.splashScreen=!1},600)}function s(t){n.splashScreen=!0,e.$timeout(function(){n.splashScreen=!1},t)}var o={show:t,hide:c,delay:s};return o}function n(){return{restrict:"E",replace:!0,templateUrl:"html/blocks/splash-screen/splash-screen.html"}}angular.module("blocks.splash").directive("splashScreen",n).factory("splash",e),e.$inject=["common","$rootScope"]}();
"use strict";!function(){function e(){return{restrict:"A",require:"ngModel",link:function(e,r,i,t){t.$render=function(){t.$viewValue.length?t.$setValidity("arrayRequired",!0):t.$setValidity("arrayRequired",!1)},t.$render()}}}angular.module("blocks.validator").directive("arrayRequired",e),e.$inject=[]}();
"use strict";!function(){function r(){function r(r,n){var e={errors:[]};return n.forEach(function(n){r.hasOwnProperty(n.field)&&!function(){var u=r[n.field];n.rules.forEach(function(r){t[r](u)||e.errors.push({field:n.field,rule:r})})}()}),e}function n(r){var n=!1;return Array.isArray(r)?r.length&&(n=!0):r&&(n=!0),n}function e(r){var n=!1;return 10===r.length&&(n=!0),n}var t={required:n,phone:e},u={run:r};return u}angular.module("blocks.validator").factory("validator",r),r.$inject=[]}();
"use strict";!function(){function r(r,o){function i(){r.open({template:"html/modals/admin/call-courier.html",width:"350px",showClose:!1,controller:"adminCallCourierModalCtrl",controllerAs:"vm"})}function e(){r.close()}var n={passOrders:"passOrders"},t=new o("adminCallCourierModal",n),a=angular.extend(t,{show:i,hide:e});return a}function o(r,o,i,e,n,t,a){function l(){i.fetchFree({},function(r){h.courierList=C(r),h.pageLoading=!1})}function u(){p.hide()}function s(r){c(r),r.showForm=!r.showForm}function c(r){h.courierList.forEach(function(o){o.id!==r.id&&(o.showForm=!1)})}function d(r){if(h.formCourier.timeToArrive){var o=n.getHourMinutes(h.formCourier.timeToArrive),i=o.hours+":"+o.minutes;e.callCourier({id:r.id,timeToArrive:i}),r.timeToArrive=i,r.showForm=!1,a.success("Інформація передана кур’єру")}}function m(r){e.declineCallCourier({id:r.id}),h.formCourier.timeToArrive="",r.timeToArrive=null,r.showForm=!1,a.success("Інформація передана кур’єру")}function f(i){e.passOrdersToCourier({id:i.id},function(){r.$broadcast(o.immediatelyRefreshPage),a.success("Замовлення видано кур’єру")}),p.hide()}function C(r){return r.map(function(r){return{account:r.account,id:r.id,timeToArrive:r.timeToArrive,showForm:!1}})}var h=this,p=t.get("adminCallCourierModal");h.pageLoading=!0,h.courierList=[],h.closeModal=u,h.showForm=s,h.callCourier=d,h.declineCall=m,h.passOrders=f,h.formCourier={timeToArrive:""},l()}angular.module("app.modals").factory("adminCallCourierModal",r).controller("adminCallCourierModalCtrl",o),r.$inject=["ngDialog","BaseModal"],o.$inject=["$rootScope","APP_EVENTS","courier","admin","helpers","BaseModal","toastr"]}();
"use strict";!function(){function e(e,t){function a(){e.open({template:"html/modals/categories/categories.html",width:"30%",showClose:!1,controller:"categoriesCreateModalCtrl",controllerAs:"vm"})}function o(){e.close()}var r={create:"create"},c=new t("createModal",r),n=angular.extend(c,{show:a,hide:o});return n}function t(e,t,a){function o(){e.create(r.form,function(){c.hide(),a.success("Категорія добавлена"),c.emit(c.events.create)})}var r=this,c=t.get("createModal");r.create=o,r.form={name:""}}angular.module("app.modals").factory("categoriesCreateModal",e).controller("categoriesCreateModalCtrl",t),e.$inject=["ngDialog","BaseModal"],t.$inject=["categories","BaseModal","toastr"]}();
"use strict";!function(){function e(e,a){function t(){e.open({template:"html/modals/dishes/create.html",width:"60%",showClose:!1,controller:"dishesCreateModalCtrl",controllerAs:"vm"})}function n(){e.close()}var o={create:"create"},s=new a("dishesCreateModal",o),r=angular.extend(s,{show:t,hide:n});return r}function a(e,a,t,n){function o(){s.spinner=!0,e.create(s.form,function(e){var t=new FormData;t.append("id",e.id),t.append("type","dish"),s.form.images.forEach(function(e){t.append("images[]",e)}),a.upload(t,function(){s.spinner=!1,r.hide(),n.success("Страву додано"),r.emit(r.events.create)})},function(){s.spinner=!1})}var s=this,r=t.get("dishesCreateModal");s.create=o,s.spinner=!1,s.form={images:[],name:"",price:"",description:"",type:"ORDINARY",categoryId:r.scope.selectedCategory.id},s.types=[{name:"Звичайний",value:"ORDINARY"},{name:"Новинка",value:"LATEST"},{name:"Гостра страва",value:"HOT"},{name:"Вегетаріанська страва",value:"VEGAN"}]}angular.module("app.modals").factory("dishesCreateModal",e).controller("dishesCreateModalCtrl",a),e.$inject=["ngDialog","BaseModal"],a.$inject=["dishes","images","BaseModal","toastr"]}();
"use strict";!function(){function e(e,n){function t(){e.open({template:"html/modals/dishes/edit.html",width:"60%",showClose:!1,controller:"dishesEditModalCtrl",controllerAs:"vm"})}function i(){e.close()}var o={update:"update"},s=new n("dishesEditModal",o),a=angular.extend(s,{show:t,hide:i});return a}function n(e,n,t,i){function o(){a.spinner=!0,s()?e.update(a.form,function(e){var t=new FormData;t.append("id",a.form.id),t.append("type","dish"),a.form.images.forEach(function(e){t.append("images[]",e)}),n.upload(t,function(){a.spinner=!1,d.hide(),i.success("Страву обновлено"),d.emit(d.events.update,e)})},function(){a.spinner=!1}):e.update(a.form,function(e){a.spinner=!1,d.hide(),i.success("Страву обновлено"),d.emit(d.events.update,e)},function(){a.spinner=!1})}function s(){var e=!1;return a.form.images.forEach(function(n){n.type&&(e=!0)}),e}var a=this,d=t.get("dishesEditModal");a.update=o,a.spinner=!1,a.form={images:d.scope.images,id:d.scope.id,name:d.scope.name,price:d.scope.price,description:d.scope.description,type:d.scope.type,categoryId:d.scope.categoryId},a.types=[{name:"Звичайний",value:"ORDINARY"},{name:"Новинка",value:"LATEST"},{name:"Гостра страва",value:"HOT"},{name:"Вегетаріанська страва",value:"VEGAN"}]}angular.module("app.modals").factory("dishesEditModal",e).controller("dishesEditModalCtrl",n),e.$inject=["ngDialog","BaseModal"],n.$inject=["dishes","images","BaseModal","toastr"]}();
"use strict";!function(){function e(e,t){function s(){e.open({template:"html/modals/dishes/select.html",showClose:!1,appendClassName:t.getClassName()+" select-modal",controller:"dishesSelectModalCtrl",controllerAs:"vm"})}function i(){var t=e.getOpenDialogs();e.close(t[1])}var n={selected:"selected"},l=new t("dishesSelectModal",n),o=angular.extend(l,{show:s,hide:i});return o}function t(e,t,s,i,n){function l(){return t.fetchAll().$promise.then(function(e){return f.categories=e,e[0]}).then(function(e){return t.fetchDishes({id:e.id}).$promise.then(function(t){f.selectedCategory=e,f.dishes=h(t)})})}function o(e){f.spinner=!0,t.fetchDishes({id:e.id},function(t){f.selectedCategory=e,f.dishes=h(t),u()})}function c(e){var t=d(e);t?t.quantity++:(e.quantity=1,f.listOfDishes.push(e))}function a(e){var t=d(e);t&&(t.quantity--,t.quantity||f.listOfDishes.splice(f.listOfDishes.indexOf(t),1))}function d(e){return s.searchByKey(f.listOfDishes,{dishId:e.dishId})}function r(){p.emit(p.events.selected,f.listOfDishes),p.hide()}function h(e){return e.map(function(e){return{dish:e,dishId:e.id,quantity:0}})}function u(){e(function(){f.spinner=!1},400)}var f=this,p=n.get("dishesSelectModal");f.spinner=!0,f.searchDish=d,f.loadDishes=o,f.incQuantity=c,f.decQuantity=a,f.pushDishes=r,f.listOfDishes=p.scope.dishes,f.categories=[],f.dishes=[],f.selectedCategory,i.all([l()]).then(function(){u()})}angular.module("app.modals").factory("dishesSelectModal",e).controller("dishesSelectModalCtrl",t),e.$inject=["ngDialog","BaseModal"],t.$inject=["$timeout","categories","helpers","$q","BaseModal"]}();
"use strict";!function(){function o(o,r){function e(){o.open({template:"html/modals/history/history.html",showClose:!1,appendClassName:r.getClassName()+" orders-history",controller:"orderHistoryModalCtrl",controllerAs:"vm"})}function t(){o.close()}var a=new r("orderHistoryModal"),l=angular.extend(a,{show:e,hide:t});return l}function r(o,r){function e(){n.hide(),r.show()}function t(o){return o.map(function(o){return angular.extend(o,{showDetail:!1})})}function a(o){o.showDetail=!o.showDetail}var l=this,n=o.get("orderHistoryModal");l.orders=t(n.scope.orders),l.hideBack=n.scope.hideBack,l.showIntervalModal=e,l.toggleOrderDetail=a}angular.module("app.modals").factory("orderHistoryModal",o).controller("orderHistoryModalCtrl",r),o.$inject=["ngDialog","BaseModal"],r.$inject=["BaseModal","orderHistoryIntervalModal"]}();
"use strict";!function(){function r(r,o){function t(){r.open({template:"html/modals/history/interval.html",width:"30%",showClose:!1,appendClassName:o.getClassName(),controller:"orderHistoryIntervalModalCtrl",controllerAs:"vm"})}function e(){r.close()}var n=new o("orderHistoryIntervalModal"),a=angular.extend(n,{show:t,hide:e});return a}function o(r,o,t){function e(){n.spinner=!0;var t={startDate:n.form.start+" 00:00:00",endDate:n.form.finish+" 00:00:00"};r.history(t,function(r){n.spinner=!1,o.scope={orders:r},a.hide(),o.show()})}var n=this,a=t.get("orderHistoryIntervalModal");n.spinner=!1,n.getOrders=e,n.form={start:"",finish:""}}angular.module("app.modals").factory("orderHistoryIntervalModal",r).controller("orderHistoryIntervalModalCtrl",o),r.$inject=["ngDialog","BaseModal"],o.$inject=["admin","orderHistoryModal","BaseModal"]}();
"use strict";!function(){function e(e,s){function o(){e.open({template:"html/modals/manager/order-detail-mini.html",showClose:!1,appendClassName:s.getClassName()+" order-detail",controller:"managerOrderDetailMiniCtrl",controllerAs:"vm"})}function r(){e.close()}var n={decline:"decline"},a=new s("managerOrderDetailMiniModal",n),l=angular.extend(a,{show:o,hide:r});return l}function s(e,s,o,r,n){function a(){t.spinner=!0,t.order=d.scope.order,n.getDishes({id:t.order.id},function(e){t.order.dishes=e,t.orderInfo=s.calculateOrderInfo(t.order),setTimeout(function(){r.$apply(function(){t.spinner=!1})},500)})}function l(){if(1==t.showCloseMessage)if(""!==t.closeMessage){var e={id:t.order.id,message:t.closeMessage,closed:!0,status:"DELIVERY_FAILED"};n.decline(e,function(){o.success("Замовлення закрите")}),d.emit(d.events.decline,t.order),d.hide()}else o.error("Введіть причину відмови від замовлення");t.showCloseMessage=!0,t.closeBtnMessage="відмінити"}function i(){t.showCloseMessage=!1,t.closeBtnMessage="відміна замовлення"}var t=this,d=e.get("managerOrderDetailMiniModal");t.closeMessage="",t.showCloseMessage=!!t.closeMessage,t.closeBtnMessage=t.closeMessage?"відмінити":"відміна замовлення",t.showCloseOrderForm=l,t.hideCloseOrderForm=i,a()}angular.module("app.modals").factory("managerOrderDetailMiniModal",e).controller("managerOrderDetailMiniCtrl",s),e.$inject=["ngDialog","BaseModal"],s.$inject=["BaseModal","helpers","toastr","$scope","orders"]}();
"use strict";!function(){function e(e,r){function s(){e.open({template:"html/modals/manager/order-detail.html",showClose:!1,appendClassName:r.getClassName()+" order-detail",controller:"managerOrderDetailCtrl",controllerAs:"vm"})}function o(){e.close()}var d={update:"update",create:"create",decline:"decline"},n=new r("managerOrderDetailModal",d),t=angular.extend(n,{show:s,hide:o});return t}function r(e,r,s,o,d,n,t,i,a,l){function c(e){var r=n.searchByKey(I.order.dishes,{dishId:e.dishId});r.quantity++}function u(e){var r=n.searchByKey(I.order.dishes,{dishId:e.dishId});r.quantity--,r.quantity||(m()?r.quantity++:I.order.dishes.splice(I.order.dishes.indexOf(r),1))}function h(e){if(!m()){var r=n.searchByKey(I.order.dishes,{dishId:e.dishId});I.order.dishes.splice(I.order.dishes.indexOf(r),1)}}function m(){return!(I.order.dishes.length-1)&&(i.error("Замовлення не можу бути порожнім!"),!0)}function f(){var e=angular.copy(I.order);r.scope.dishes=e.dishes,r.show()}function p(){o.history({clientPhone:I.order.client.phoneNumber},function(e){s.scope={orders:e,hideBack:!0},s.show()})}function g(){if(1==I.showCloseMessage)if(""!==I.closeMessage){var e={id:I.order.id,message:I.closeMessage,closed:!0,status:"DECLINED"};l.decline(e,function(){i.success("Замовлення відмінено")}),O.emit(O.events.decline,I.order),O.hide()}else i.error("Введіть причину відмови від замовлення");I.showCloseMessage=!0,I.closeBtnMessage="відмінити"}function v(){I.showCloseMessage=!1,I.closeBtnMessage="відміна замовлення"}function M(){I.order.dishes.length?I.createEnabled?y():D():i.error("Замовлення не можу бути порожнім!")}function y(){I.order.status="KITCHEN";var e=null;if(I.order.timeToDeliver){var r=n.getDate(),s=n.convertHHmm(I.order.timeToDeliver);e=r.str+" "+s+":00"}var o={id:I.order.id,client:{name:I.order.client.name,phone:I.order.client.phoneNumber,address:I.order.client.address},dishes:I.order.dishes,timeToDeliver:e,status:I.order.status};O.hide(),l.create(o,function(e){O.emit(O.events.create,e),i.success("Замовлення оформлено")})}function D(){I.order.status="KITCHEN";var e=null;if(I.order.timeToDeliver){var r=n.getDate(),s=n.convertHHmm(I.order.timeToDeliver);e=r.str+" "+s+":00"}var o={id:I.order.id,client:{name:I.order.client.name,phone:I.order.client.phoneNumber,address:I.order.client.address},dishes:I.order.dishes,timeToDeliver:e,status:I.order.status};O.emit(O.events.update,I.order),O.hide(),l.update(o,function(){i.success("Замовлення оформлено")})}function C(e){var r=!1,s=t.run(e.client,N),o=t.run(e,b);return s.errors.length||o.errors.length||(r=!0),r}function w(e){return e.map(function(e){return{dish:e.dish,id:e.id,dishId:e.dish.id,quantity:e.quantity}})}function H(){d.makeCall({line:"901",phone:I.order.client.phoneNumber})}var I=this,O=e.get("managerOrderDetailModal"),N=[{field:"name",rules:["required"]},{field:"address",rules:["required"]},{field:"phoneNumber",rules:["required","phone"]}],b=[{field:"dishes",rules:["required"]}];if(I.createEnabled=O.scope.createEnabled,I.createEnabled){var q={client:{address:"",name:"",phoneNumber:""},dishes:[],status:"FRESH"};I.order=q}else I.spinner=!0,I.order=O.scope.order,l.getDishes({id:I.order.id},function(e){I.order.dishes=w(e),setTimeout(function(){a.$apply(function(){I.spinner=!1})},500)});I.closeMessage="",I.showCloseMessage=!!I.closeMessage,I.closeBtnMessage=I.closeMessage?"відмінити":"відміна замовлення",I.orderValid=!0,I.selectDishesModal=f,I.historyOrdersModal=p,I.incQuantity=c,I.decQuantity=u,I.removeDish=h,I.showCloseOrderForm=g,I.hideCloseOrderForm=v,I.saveOrder=M,I.convertHHmm=n.convertHHmm,I.makeCall=H,a.$watch(function(){return I.order.dishes},function(e){e&&(I.orderInfo=n.calculateOrderInfo(I.order))},!0),a.$watch(function(){return I.order},function(e){C(e)?I.orderValid=!0:I.orderValid=!1},!0),r.on(r.events.selected,function(e){I.order.dishes=e})}angular.module("app.modals").factory("managerOrderDetailModal",e).controller("managerOrderDetailCtrl",r),e.$inject=["ngDialog","BaseModal"],r.$inject=["BaseModal","dishesSelectModal","orderHistoryModal","admin","operator","helpers","validator","toastr","$scope","orders"]}();
"use strict";!function(){function e(e,o,n,t,r,i,s){function c(){return e.fetchAvailable({}).$promise.then(function(e){m.callCenter=a(e,p.callCenter).sort(i.compareById),m.kitchen=a(e,p.kitchen).sort(i.compareById),m.delivery=a(e,p.delivery).sort(i.compareById),m.ordersLoading=!1})}function a(e,o){var n=[];return e.forEach(function(e){i.findString(o,e.status)&&n.push(e)}),n}function l(e){h=e,h.timeToDeliver&&(h.timeToDeliver=i.parseDate(h.timeToDeliver)),s.open({template:"html/modals/order-detail-admin.html",className:"ngdialog-theme-default order-detail",controller:u})}function d(e){var o={price:0,count:0},n=!0,t=!1,r=void 0;try{for(var i,s=e.dishes[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value;o.price+=c.dish.price*c.quantity,o.count+=c.quantity}}catch(a){t=!0,r=a}finally{try{!n&&s["return"]&&s["return"]()}finally{if(t)throw r}}return o}function u(e,o,n,t,r){function i(o){t.getDishes({id:o.id},function(n){o.dishes=n,e.order=o,e.orderInfo=d(o),setTimeout(function(){e.$apply(function(){e.spinner=!1})},500)})}function c(){g=s.open({template:"html/modals/order-delivery-admin.html",width:"350px",showClose:!1,controller:f})}function a(){h.status="COOKING",r.makeInCooking({id:h.id},function(){n.success("Замовлення відправлено на кухню")}),s.close()}e.spinner=!0,e.closeMessage="",e.showCloseMessage=!!e.closeMessage,e.closeBtnMessage=e.closeMessage?"відмінити":"відміна замовлення",e.showModalDelivery=c,e.makeInCooking=a,e.convertHHmm=o.convertHHmm,i(h),e.showCloseOrderForm=function(){if(1==e.showCloseMessage)if(""!==e.closeMessage){var r={id:e.order.id,status:"CANT_PREPARE",closed:!0,message:e.closeMessage};t.decline(r,function(){n.success("Замовлення відмінено")});var i=o.searchByKey(m.kitchen,{id:h.id});m.kitchen.splice(m.kitchen.indexOf(i),1),m.kitchen.sort(o.compareById),s.close()}else n.error("Введіть причину відмови від замовлення");e.showCloseMessage=!0,e.closeBtnMessage="відмінити"},e.hideCloseOrderForm=function(){e.showCloseMessage=!1,e.closeBtnMessage="відміна замовлення"}}function f(o,n,t){function r(){n.fetchAll({},function(e){o.courierList=d(e),o.pageLoading=!1})}function s(){g.close()}function c(e){"BUSY"===e.status?t.warning("Кур’єр зайнятий"):(a(e),e.showForm=!e.showForm)}function a(e){o.courierList.forEach(function(o){o.id!==e.id&&(o.showForm=!1)})}function l(o){if(h.timeToDeliver){var n=i.getDate(),r=i.convertHHmm(h.timeToDeliver),c=n.str+" "+r+":00";e.update({id:h.id,courierId:o.id,pending:!0,timeToDeliver:c}),h.courier=o,t.success("Інформація передана кур’єру"),s()}else t.warning("Необхідно спочатку вказати час доставки.")}function d(e){var o=e.filter(function(e){if("OUT"!==e.status)return!0});return o.map(function(e){var o="FREE"===e.status,n=o?"вільний":"зайнятий";return{account:e.account,id:e.id,messagingToken:e.messagingToken,status:e.status,statusText:n,free:o,showForm:!1}})}o.closeModal=s,o.showForm=c,o.sendCourier=l,o.courierList=[],o.pageLoading=!0,r()}var m=this;m.callCenter=[],m.kitchen=[],m.delivery=[],m.ordersLoading=!0,m.showModalOrder=l;var h=void 0,g=void 0,p={callCenter:["FRESH","IN_PROGRESS"],kitchen:["KITCHEN","COOKING","PREPARED"],delivery:["DELIVERY","DONE"]};c(),n.$on(o.refreshPage,function(){t.all([c()]).then(function(){n.$emit(o.refreshPageDone)})}),u.$inject=["$scope","helpers","toastr","orders","admin"],f.$inject=["$scope","courier","toastr"]}angular.module("app.admin.dashboard").controller("DashboardAdmin",e),e.$inject=["orders","APP_EVENTS","$scope","$q","admin","helpers","ngDialog"]}();
"use strict";!function(){function a(a,o){a.configureRoutes(n(o))}function n(a){return[{url:"/admin/dashboard",config:{templateUrl:"html/components/admin/dashboard/dashboard.html",controller:"DashboardAdmin",controllerAs:"dash",data:{authorities:[a.admin]}}}]}a.$inject=["routehelper","USER_ROLES"],n.$inject=["USER_ROLES"],angular.module("app.admin.dashboard").run(a)}();
"use strict";!function(){function e(e,t,i,s,n,o,c,r){function d(){return n.fetchAll().$promise.then(function(e){return g.categories=e,e[0]}).then(function(e){return n.fetchDishes({id:e.id}).$promise.then(function(t){g.selectedCategory=e,g.dishes=t})})}function a(e){g.spinner=!0,n.fetchDishes({id:e.id},function(t){g.selectedCategory=e,g.dishes=t,f()})}function h(){var e="Ви справді бажаєте видалити категорію - "+g.selectedCategory.name+"?";confirm(e)&&n.remove({id:g.selectedCategory.id},function(){var e=s.searchByKey(g.categories,{id:g.selectedCategory.id});g.categories.splice(g.categories.indexOf(e),1),g.selectedCategory=g.categories[0],a(g.categories[0]),r.success("Категорія видалена")})}function l(e){var t="Ви справді бажаєте видалити страву?";confirm(t)&&n.removeDish({id:g.selectedCategory.id,dishes:[{id:e}]},function(){var t=s.searchByKey(g.dishes,{id:e});g.dishes.splice(g.dishes.indexOf(t),1),r.success("Страву видалено")})}function u(e){var i=angular.extend({categoryId:g.selectedCategory.id},e),s=angular.copy(i);t.scope=s,t.show()}function f(){o(function(){g.spinner=!1},400)}var g=this;e.scope=g,g.spinner=!0,g.loadDishes=a,g.removeDish=l,g.removeCategory=h,g.showModalDishAdd=e.show,g.showModalCategoryAdd=i.show,g.showModalDishEdit=u,g.selectedCategory,c.all([d()]).then(function(){f()}),e.on(e.events.create,function(){n.fetchDishes({id:g.selectedCategory.id},function(e){g.dishes=e})}),t.on(t.events.update,function(e){n.fetchDishes({id:g.selectedCategory.id},function(e){g.dishes=e})}),i.on(i.events.create,function(){n.fetchAll({},function(e){g.categories=e})})}angular.module("app.admin.panel").controller("Panel",e),e.$inject=["dishesCreateModal","dishesEditModal","categoriesCreateModal","helpers","categories","$timeout","$q","toastr"]}();
"use strict";!function(){function n(n,t){n.configureRoutes(e(t))}function e(n){return[{url:"/admin/panel",config:{templateUrl:"html/components/admin/panel/panel.html",controller:"Panel",controllerAs:"panel",data:{authorities:[n.admin]}}}]}n.$inject=["routehelper","USER_ROLES"],angular.module("app.admin.panel").run(n)}();
"use strict";!function(){function n(n,o,e,r){var s=this;s.form={username:"",password:""},s.login=function(){o.login(s.form).then(function(){var s=o.info();r.success("Вхід здійснено успішно: "+s.sub),e.delay(1500),n.defaultRedirect()})["finally"](function(){s.form={username:"",password:""}})}}angular.module("app.auth").controller("Auth",n),n.$inject=["$rootScope","user","splash","logger"]}();
"use strict";!function(){function t(t,n){t.configureRoutes(u(n))}function u(t){return[{url:"/auth",config:{templateUrl:"html/components/common/auth/auth.html",controller:"Auth",controllerAs:"auth",data:{authorities:[t.guest]}}}]}t.$inject=["routehelper","USER_ROLES"],u.$inject=["USER_ROLES"],angular.module("app.auth").run(t)}();
"use strict";!function(){function e(e,r,o,n,t,i,c){function d(){return r.fetchAll({}).$promise.then(function(e){k.cooking=o.filterOrdersByStatus(e,O.cooking).sort(o.compareById),k.prepared=o.filterOrdersByStatus(e,O.prepared).sort(o.compareById),h(k.cooking),h(k.prepared),k.ordersLoad=!0})}function a(e){var o=l(e);o.toggle=!1,s(e),r.prepared({id:e.id},function(){n.success("Статус замовлення змінено")})}function p(e){var o=l(e);o.toggle=!1,u(e),r.notPrepared({id:e.id},function(){n.success("Статус замовлення змінено")})}function s(e){k.cooking.splice(k.cooking.indexOf(e),1),k.prepared.push(e),k.prepared.sort(o.compareById)}function u(e){k.prepared.splice(k.prepared.indexOf(e),1),k.cooking.push(e),k.cooking.sort(o.compareById)}function f(e){var r=l(e);r&&(r.toggle=!r.toggle)}function g(){e(function(){k.spinner=!1},400)}function l(e){return o.searchByKey(m,{id:e.id})}function h(e){e.forEach(function(e){l(e)||m.push({id:e.id,toggle:!1})})}var k=this;k.spinner=!0,k.orders=[],k.makePrepared=a,k.makeNotPrepared=p,k.toggleDetailOrder=f,k.findToggleOrder=l,k.ordersLoad=!1;var m=[],O={cooking:["COOKING"],prepared:["PREPARED"]};c.all([d()]).then(function(){g()}),i.$on(t.refreshPage,function(){c.all([d()]).then(function(){i.$emit(t.refreshPageDone)})})}angular.module("app.kitchen.orders").controller("Orders",e),e.$inject=["$timeout","kitchen","helpers","toastr","APP_EVENTS","$scope","$q"]}();
"use strict";!function(){function e(e,t){e.configureRoutes(r(t))}function r(e){return[{url:"/kitchen/orders",config:{templateUrl:"html/components/kitchen/orders/orders.html",controller:"Orders",controllerAs:"kitchen",data:{authorities:[e.kitchen]}}}]}e.$inject=["routehelper","USER_ROLES"],r.$inject=["USER_ROLES"],angular.module("app.kitchen.orders").run(e)}();
"use strict";!function(){function e(e,r,n,t,a,i,o,c){function l(){return e.fetchAvailable({}).$promise.then(function(e){p.callCenter=s(e,y.callCenter).sort(i.compareById),p.kitchen=s(e,y.kitchen).sort(i.compareById),p.delivery=s(e,y.delivery).sort(i.compareById),p.ordersLoading=!1})}function s(e,r){var n=[];return e.forEach(function(e){i.findString(r,e.status)&&n.push(e)}),n}function d(e,r){v=e,f=r,"FRESH"===v.status&&u(v);var n=angular.copy(v);n.timeToDeliver&&(n.timeToDeliver=i.parseDate(n.timeToDeliver)),r?(o.scope.createEnabled=!1,o.scope.order=n,o.show()):(c.scope.order=n,c.show())}function u(e){e.status="IN_PROGRESS",r.makeInProgress({id:e.id})}function h(e){var r=i.searchByKey(p.callCenter,{id:e.id});p.callCenter.splice(p.callCenter.indexOf(r),1),p.kitchen.push(e),p.kitchen.sort(i.compareById)}var p=this;p.callCenter=[],p.kitchen=[],p.delivery=[],p.ordersLoading=!0,p.showModalOrder=d,p.makeInProgress=u;var v=void 0,f=!0,y={callCenter:["FRESH","IN_PROGRESS"],kitchen:["KITCHEN","COOKING","PREPARED"],delivery:["DELIVERY","DONE"]};l(),t.$on(n.refreshPage,function(){a.all([l()]).then(function(){t.$emit(n.refreshPageDone)})}),o.on(o.events.create,function(e){p.kitchen.push(e),p.kitchen.sort(i.compareById)}),o.on(o.events.update,function(e){h(e)}),o.on(o.events.decline,function(e){var r=i.searchByKey(p.callCenter,{id:e.id});p.callCenter.splice(p.callCenter.indexOf(r),1),p.callCenter.sort(i.compareById)}),c.on(c.events.decline,function(e){var r=i.searchByKey(p.delivery,{id:e.id});p.delivery.splice(p.delivery.indexOf(r),1),p.delivery.sort(i.compareById)})}angular.module("app.manager.dashboard").controller("DashboardManager",e),e.$inject=["orders","operator","APP_EVENTS","$scope","$q","helpers","managerOrderDetailModal","managerOrderDetailMiniModal"]}();
"use strict";!function(){function a(a,n){a.configureRoutes(r(n))}function r(a){return[{url:"/manager/dashboard",config:{templateUrl:"html/components/manager/dashboard/dashboard.html",controller:"DashboardManager",controllerAs:"dash",data:{authorities:[a.manager]}}}]}a.$inject=["routehelper","USER_ROLES"],r.$inject=["USER_ROLES"],angular.module("app.manager.dashboard").run(a)}();
//# sourceMappingURL=bundle.min.js.map
